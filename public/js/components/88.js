(window.webpackJsonp=window.webpackJsonp||[]).push([[88],{Ll3F:function(t,e,s){"use strict";var a=s("L2JU");function i(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function r(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var n={props:{title:{default:""},titleIcon:{default:""},titleDesc:{default:""},level:{default:1},level2Title:{default:""},level2Route:{default:""}},methods:{level2Back:function(){this.$emit("level2Back")},route1:function(){this.btn1RouteParams?this.$router.push({name:this.btn1Route,params:{cu:this.btn1RouteParams}}):this.$router.push({name:this.btn1Route})},route2:function(){this.btn2RouteParams?this.$router.push({name:this.btn2Route,params:{cu:this.btn2RouteParams}}):this.$router.push({name:this.btn2Route})},route3:function(){this.btn3RouteParams?this.$router.push({name:this.btn3Route,params:{cu:this.btn3RouteParams}}):this.$router.push({name:this.btn3Route})}},computed:function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?i(Object(s),!0).forEach((function(e){r(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},Object(a.b)("auth",{currentUser:"currentUser"}))},o=s("KHd+"),l=Object(o.a)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"page-header"},[s("div",{staticClass:"page-header-content header-elements-md-inline"},[s("div",{staticClass:"page-title d-flex"},[s("h4",[s("i",{staticClass:"mr-2",class:t.titleIcon}),t._v(" "),s("span",{staticClass:"font-weight-semibold"},[t._v(t._s(t.title))]),t._v(" "),s("small",{staticClass:"d-block text-muted"},[t._v(t._s(t.titleDesc))])])]),t._v(" "),s("div",{staticClass:"header-elements d-none py-0 mb-3 mb-md-0"},[1===t.level?s("div",{staticClass:"breadcrumb"},[s("router-link",{staticClass:"breadcrumb-item",attrs:{to:{name:"dashboard"}}},[s("i",{staticClass:"icon-home4"}),t._v("  Dashboard ")]),t._v(" "),s("span",{staticClass:"breadcrumb-item active"},[t._v(t._s(t.title))])],1):t._e(),t._v(" "),2===t.level?s("div",{staticClass:"breadcrumb"},[s("router-link",{staticClass:"breadcrumb-item",attrs:{to:{name:"dashboard"}}},[s("i",{staticClass:"icon-home4"}),t._v(" Dashboard ")]),t._v(" "),s("a",{staticClass:"breadcrumb-item",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.level2Back()}}},[t._v(t._s(t.level2Title))]),t._v(" "),s("span",{staticClass:"breadcrumb-item active"},[t._v(t._s(t.title))])],1):t._e(),t._v(" "),3===t.level?s("div",{staticClass:"breadcrumb"},[t._t("breadcrumb")],2):t._e()])])])])}),[],!1,null,null,null);e.a=l.exports},b2K9:function(t,e,s){"use strict";s.r(e);var a=s("L2JU"),i=s("Ll3F"),r=s("8MVx"),n=s("IIPP"),o=s.n(n),l=s("vDqi"),c=s.n(l);function u(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function d(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var p={props:{title:{type:String}},data:function(){return{message:null,files:[],stat:"",count:"",progress:[],progressBar:0,isLoading:!1,submited:!1,isClicked:!1}},methods:{submit:function(t){var e=this;this.isLoading=!0;for(var s=0;s<this.files.length;s++){var a=new FormData;a.append("file",this.files[s]),a.append("id_cu",this.currentUser.id_cu),a.append("id_user",this.currentUser.id),a.append("file_name",this.title),c.a.post("/api/fileUpload/store",a,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(t){this.progressBar=parseInt(Math.round(100*t.loaded/t.total))}.bind(this)}).then((function(t){200==t.status&&e.$store.commit("fileUpload/setDataS",t.data.model),setTimeout((function(){e.$emit("LoadingStat",e.isLoading),e.message=t.data.message,e.progressBar=0,e.reset(),e.files=[]}))}))}},reset:function(){this.$refs.file.value=""},click:function(){this.isClicked=!0,this.$emit("fileBatal",this.title)},upload:function(t){this.isClicked=!1,this.files=[],this.message=null,this.files.push(t.files[0]),this.$emit("fileSelected",{file:this.files,name:this.title})}},computed:function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?u(Object(s),!0).forEach((function(e){d(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):u(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},Object(a.b)("auth",{currentUser:"currentUser"}))},h=s("KHd+"),f=Object(h.a)(p,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("form",{attrs:{action:"javascript:void(0)",enctype:"multipart/form-data",method:"post"}},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-header bg-white"},[s("h5",{staticClass:"card-title"},[t._v(t._s(this.title))])]),t._v(" "),s("div",{staticClass:"card-body"},[t.message?s("div",{staticClass:"alert alert-success"},[t._v(t._s(t.message))]):t._e(),t._v(" "),s("input",{ref:"file",staticClass:"form-control",attrs:{type:"file",accept:".csv,.xlsx,.xls",name:"file"},on:{click:t.reset,change:function(e){return t.upload(e.target)}}}),t._v(" "),s("hr"),t._v(" "),s("div",{staticClass:"progress"},[s("div",{staticClass:"progress-bar",style:{width:t.progressBar+"%"},attrs:{role:"progressbar","aria-valuenow":t.progressBar,"aria-valuemin":"0","aria-valuemax":"100"}},[t._v(t._s(t.progressBar)+"%")])]),t._v(" "),s("input",{staticClass:"btn btn-danger btn-block btn-sm",staticStyle:{"margin-top":"5px"},attrs:{disabled:t.files.length<=0||t.isClicked,type:"button",value:"BATAL"},on:{click:[t.click,function(e){return e.preventDefault(),t.reset(e)}]}})])])])}),[],!1,null,null,null).exports;function m(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function b(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?m(Object(s),!0).forEach((function(e){g(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):m(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function g(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var v={components:{pageHeader:i.a,appModal:r.a,Cleave:o.a,singleFileUpload:f},data:function(){return{isLoading:!0,selectedItem:null,title:"Import ESCETE",titleDesc:"Melakukan upload data CSV ESCETE",titleIcon:"icon-file-upload2",kelas:"testUpload",loadingCount:[],files:[],fileCounter:0,modalShow:!1,isDraft:!1,flagRekening:!1,flagAnggota:!1,flagProduk:!1,modalState:"",modalTitle:"",modalColor:"",modalContent:"",modalSize:""}},watch:{loadingCount:function(){0!=this.loadingCount.length&&this.loadingCount.length==this.fileCounter&&(this.files=[],this.loadingCount=[],this.$store.dispatch("anggotaCuImportEscete/index",[this.currentUser.id_cu,this.currentUser.id]),this.$store.dispatch("fileUpload/index",[this.currentUser.id_cu,this.currentUser.id]))},uploadStat:function(t){this.modalShow=!0,this.modalState=t,this.modalColor="","success"==t?(this.$store.dispatch("anggotaCuImportEscete/index",[this.currentUser.id_cu]),this.$store.dispatch("fileUpload/index",[this.currentUser.id_cu,this.currentUser.id]),this.modalTitle=this.uploadResponse.message):(this.modalTitle="Oops terjadi kesalahan :(",this.modalContent=this.uploadResponse)},updateStat:function(t){this.modalShow=!0,this.modalState=t,this.modalColor="","success"==t?(this.$store.dispatch("anggotaCuImportEscete/index",[this.currentUser.id_cu]),this.$store.dispatch("fileUpload/index",[this.currentUser.id_cu,this.currentUser.id]),this.modalTitle=this.updateResponse.message):(this.modalTitle="Oops terjadi kesalahan :(",this.modalContent=this.updateResponse)},files:function(){0==this.files.length&&(this.isLoading=!0)},tipe:function(){"single"==this.tipe?this.cekTipe=!0:this.cekTipe=!1}},created:function(){this.$store.dispatch("anggotaCuImportEscete/index",[this.currentUser.id_cu,this.currentUser.id]),this.$store.dispatch("fileUpload/index",[this.currentUser.id_cu,this.currentUser.id])},methods:{modalOpen:function(t,e,s){this.modalShow=!0,this.state=t,e&&(this.selectedItem=s),"hapus"==t&&(this.modalState="confirm-tutup",this.modalColor="",this.modalTitle="Hapus file "+this.selectedItem.file_name+"?",this.modalButton="Iya, Hapus"),"upload_draft"==t&&(this.modalState="confirm-tutup",this.modalColor="",this.modalTitle="Upload file ke draft?",this.modalButton="Upload"),"simpan_draft"==t&&(this.modalState="confirm-tutup",this.modalColor="",this.modalTitle="simpan draft?",this.modalButton="Upload")},modalConfirmOk:function(){this.modalShow=!1,"hapus"==this.state&&this.$store.dispatch("fileUpload/destroy",this.selectedItem.id),"upload_draft"==this.state&&this.$store.dispatch("anggotaCuImportEscete/draft",[this.currentUser.id_cu,this.currentUser.id]),"simpan_draft"==this.state&&this.$store.dispatch("anggotaCuImportEscete/simpanDraft",this.currentUser.id_cu)},modalTutup:function(){this.modalShow=!1},modalBackgroundClick:function(){"success"==this.modalState?this.modalTutup:"loading"==this.modalState||(this.modalShow=!1),this.isDisableTablePeserta=!1},submit:function(){this.loadingCount=[],this.isLoading=!0,console.log("ya"),1==this.flagProduk&&this.$refs.formProduk.submit(),1==this.flagAnggota&&this.$refs.formAnggota.submit(),1==this.flagRekening&&this.$refs.formRekening.submit()},setLoadingStat:function(t){this.loadingCount.push(t)},setFileCount:function(t){this.isLoading=!1,0==this.flagAnggota&&"DATA_ANGGOTA"==t.name?(this.flagAnggota=!0,this.fileCounter++):0==this.flagRekening&&"DATA_REKENING"==t.name?(this.flagRekening=!0,this.fileCounter++):0==this.flagProduk&&"DATA_PRODUK"==t.name&&(this.flagProduk=!0,this.fileCounter++);var e={name:t.name,file:t.file};this.files.push(e)},remove:function(t){1==this.flagAnggota&&"DATA_ANGGOTA"==t?(this.flagAnggota=!1,this.fileCounter--):1==this.flagRekening&&"DATA_REKENING"==t?(this.flagRekening=!1,this.fileCounter--):1==this.flagProduk&&"DATA_PRODUK"==t&&(this.flagProduk=!1,this.fileCounter--);var e=this.files.map((function(t){return t.name})).indexOf(t);this.files.splice(e,1)},setSelectedItem:function(t){this.selectedItem=t},SimpanDraft:function(){}},computed:b(b(b(b({},Object(a.b)("auth",{currentUser:"currentUser"})),Object(a.b)("anggotaCuImportEscete",{uploadResponse:"update",uploadStat:"updateStat",Draft:"isDraft"})),Object(a.b)("fileUpload",{dataS:"dataS",updateResponse:"update",updateStat:"updateStat"})),Object(a.b)("cu",{modelCU:"headerDataS",modelCUStat:"headerDataStatS"}))},_=Object(h.a)(v,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("page-header",{attrs:{title:t.title,titleDesc:t.titleDesc,titleIcon:t.titleIcon}}),t._v(" "),s("div",{staticClass:"page-content pt-0"},[s("div",{staticClass:"content-wrapper"},[s("div",{staticClass:"content"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-sm-12"},[s("singleFileUpload",{ref:"formAnggota",attrs:{title:"DATA_ANGGOTA"},on:{LoadingStat:t.setLoadingStat,fileSelected:t.setFileCount,fileBatal:function(e){return t.remove("DATA_ANGGOTA")}}}),t._v(" "),s("singleFileUpload",{ref:"formRekening",attrs:{title:"DATA_REKENING"},on:{LoadingStat:t.setLoadingStat,fileSelected:t.setFileCount,fileBatal:function(e){return t.remove("DATA_REKENING")}}}),t._v(" "),s("singleFileUpload",{ref:"formProduk",attrs:{title:"DATA_PRODUK"},on:{LoadingStat:t.setLoadingStat,fileSelected:t.setFileCount,fileBatal:function(e){return t.remove("DATA_PRODUK")}}})],1),t._v(" "),s("div",{staticClass:"col-sm-12"},[s("div",{staticClass:"card card-body"},[s("input",{staticClass:"btn btn-primary ",attrs:{disabled:t.isLoading,type:"button",value:"Upload"},on:{click:function(e){return e.preventDefault(),t.submit(e)}}})])]),t._v(" "),s("div",{staticClass:"col-sm-12"},[s("div",{staticClass:"card"},[t._m(0),t._v(" "),s("div",{staticClass:"card-body"},[s("div",{staticClass:"row"},[t._l(t.dataS,(function(e,a){return s("div",{key:a,staticClass:"col-md-4"},[s("div",{staticClass:"card"},[s("div",{staticClass:"card-body"},[s("h5",{staticClass:"card-title"},[t._v(t._s(e.tipe))]),t._v(" "),s("h5",{staticClass:"card-title"},[t._v(t._s(e.file_name))]),t._v(" "),s("input",{staticClass:"btn btn-danger ",attrs:{type:"button",value:"HAPUS"},on:{click:[function(s){return s.preventDefault(),t.setSelectedItem(e)},function(e){return e.preventDefault(),t.modalOpen("hapus")}]}})])])])})),t._v(" "),t.dataS.length<=0?s("div",{staticClass:"col-sm-12"},[t._v("File upload tidak ditemukan")]):t._e()],2)])])]),t._v(" "),s("div",{staticClass:"col-sm-12"},[s("div",{staticClass:"card card-body"},[0!=t.currentUser.id_cu?s("input",{staticClass:"btn btn-warning mb-2",attrs:{disabled:t.dataS.length<=0,type:"button",value:"Upload Ke Draft"},on:{click:function(e){return e.preventDefault(),t.modalOpen("upload_draft")}}}):t._e(),t._v(" "),0==t.currentUser.id_cu?s("input",{staticClass:"btn btn-warning mb-2",attrs:{type:"button",value:"Upload Ke Draft"},on:{click:function(e){return e.preventDefault(),t.modalOpen("upload_draft")}}}):t._e(),t._v(" "),s("input",{staticClass:"btn btn-success mb-2",attrs:{disabled:!t.Draft,type:"button",value:"Simpan Draft"},on:{click:function(e){return e.preventDefault(),t.modalOpen("simpan_draft")}}})])])])])])]),t._v(" "),s("app-modal",{attrs:{show:t.modalShow,state:t.modalState,title:t.modalTitle,content:t.modalContent,size:t.modalSize,color:t.modalColor},on:{batal:t.modalTutup,tutup:t.modalTutup,confirmOk:t.modalConfirmOk,successOk:t.modalTutup,failOk:t.modalTutup,backgroundClick:t.modalBackgroundClick}},[s("template",{slot:"modal-title"},[t._v("\n\t\t\t\t"+t._s(t.modalTitle)+"\n\t\t\t")])],2)],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"card-header bg-white"},[e("h5",{staticClass:"card-title"},[this._v("List File")])])}],!1,null,null,null);e.default=_.exports}}]);